include std.cn
include wasm/web.cn

var button_counter int

nproc button_event JSEvent e:
  *button_counter inc
  e.target let target;
  button_counter int_to_str init var string JSString
  string "innerText" target.set
  string.data free
  e.free target.free
end

"btn" JSString "getElementById" document.call_method1 JSEventTarget.full_unwrap let btn;

"click" *button_event
btn.add_event_listener
btn.free